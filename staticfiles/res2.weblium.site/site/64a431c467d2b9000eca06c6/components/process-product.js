(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"../client/editor-next/src/components/block-components/constructor/types/product/media/find-fitting-image.js":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.prepareImageVariants=t.getBiggestVariant=t.findFittingImage=void 0;var r=e.pipe(e.keys,e.map(Number),e.filter(e.identity),e.sortBy(e.identity));t.prepareImageVariants=r;var n=function(e,t){var r=e.reduce(function(e,r){return e||(t>r?0:r)},0);return r?r.toString():"original"};t.getBiggestVariant=n;t.findFittingImage=function(e,t){return e[n(r(e),t)]}}).call(this,r("../client/node_modules/lodash/fp.js"))},"../client/editor-next/src/components/block-components/constructor/types/product/view/process-product.js":function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.processProductList=t.processProduct=void 0;var n=r("../client/editor-next/src/components/block-components/collection/view/slider/utils.js"),o=r("../client/editor-next/src/components/block-components/ecommerce/utils/prepare-app-info.js"),c=r("../client/shared/api/ecommerce/http-common.js"),i=r("../client/editor-next/src/components/block-components/ecommerce-shopping-cart/view/utils.js"),a=r("../client/editor-next/src/components/block-components/ecommerce/shopping-cart-next-view/utils.js"),s=r("../client/editor-next/src/components/block-components/ecommerce/utils/generate-preview-sizes.js"),u=r("../client/shared/utils/dom.js"),p=r("../client/editor-next/src/components/block-components/constructor/types/product/view/stock-manager.js"),l=r("../client/editor-next/src/components/block-components/constructor/types/product/media/find-fitting-image.js");function d(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t,r,n,o,c,i){try{var a=e[c](i),s=a.value}catch(e){return void r(e)}a.done?t(s):Promise.resolve(s).then(n,o)}function v(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var c=e.apply(t,r);function i(e){m(c,n,o,i,a,"next",e)}function a(e){m(c,n,o,i,a,"throw",e)}i(void 0)})}}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach(function(t){y(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var w=new Map,h=function(e,t){var r=e.querySelector(t);return document.importNode(r.content,!0).children[0]},j=e.curry(function(e,t){var r=e.appInstance;return g(g({},t),{},{url:"".concat(r.routes[0]).concat(t.slug),sku:t.variant.sku,price:(0,i.formatPrice)(t.variant.amount,(0,a.mapAppInstance)(r)),priceOld:!!t.variant.amount_old&&(0,i.formatPrice)(t.variant.amount_old||0,(0,a.mapAppInstance)(r)),statusFormatted:t.variant.formatted.status,hasPreview:!!t.preview,outOfStock:!t.formatted.available})}),O=["{%","%}"],P={rootMargin:(0,u.getDefaultRootMargin)()},S=new IntersectionObserver(function(e,t){e.forEach(function(e){var r=e.target;if(e.isIntersecting){t.unobserve(r);var n=r.dataset.productId,o=r.querySelector(".js-preview-img");o&&w.has(n)&&(o.src=(0,l.findFittingImage)(w.get(n),r.clientWidth))}})},P),k=function(){var t=v(regeneratorRuntime.mark(function t(r){var n,i,a,u,l,d,f,m,v,b,y,P;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.wrapper,i=r.appInstance,a=r.Mustache,u=(0,o.prepareAppInfo)(),l=u.appId,d=u.apiUrl,f=n.dataset.productId){t.next=5;break}return t.abrupt("return");case 5:return m=n.querySelector(".js-product-card-target-element"),t.prev=6,t.next=9,(0,c.loadProduct)(d,l,f);case 9:if(!(v=t.sent).error){t.next=12;break}throw new Error(v.error);case 12:v.preview&&w.set(f,(0,s.generatePreviewSizes)(v.preview.url)),b=j({appInstance:i},v),(0,p.updateStockWithVariantsInventory)(b),y=h(n,".js-product-card-template"),m.innerHTML=a.render(y.outerHTML,g(g({},b),{},{ribbons:e.getOr({},"meta_data.ribbons",i)}),{},O),m.dataset.productId=f,S.observe(m),t.next=25;break;case 21:t.prev=21,t.t0=t.catch(6),P=h(n,".js-product-card-error-template"),m.replaceChildren(P);case 25:case"end":return t.stop()}},t,null,[[6,21]])}));return function(e){return t.apply(this,arguments)}}();t.processProduct=k;var I=function(e){return e.forEach(function(e){e.preview&&w.set(e.id,(0,s.generatePreviewSizes)(e.preview.url))}),e},x=function(){var t=v(regeneratorRuntime.mark(function t(r){var n,i,a,s,u,l,d,f,m,v,b,g,y,w,h,P;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.wrapper,i=r.appInstance,a=r.Mustache,s=(0,o.prepareAppInfo)(),u=s.appId,l=s.apiUrl,d=JSON.parse(n.dataset.value),f=d.categorySlugIds,m=d.showOutOfStock,v=d.productsDisplayed,b=void 0===v?100:v,g=d.sortOrder,y=void 0===g?"name":g,w=n.querySelector(".js-product-list-wrapper"),t.next=6,(0,c.loadCategories)(u,l,f).then(function(t){return t.map(e.prop("id"))}).then(function(e){return(0,c.loadCategoryProducts)(u,l,e,m,b,y)}).then(I).then(function(e){return e.forEach(p.updateStockWithVariantsInventory),e}).then(e.map(j({appInstance:i})));case 6:h=t.sent,P=n.querySelector(".js-product-card-template").innerHTML,w.innerHTML=a.render(P,{products:h,ribbons:e.getOr({},"meta_data.ribbons",i)},{},O),Array.from(w.children).forEach(function(e){return S.observe(e)});case 10:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();t.processProductList=x,(0,n.addSliderMountListener)(function(e){var t=e.querySelectorAll(".js-product-card-target-element"),r=e.querySelectorAll(".js-product-list-wrapper"),n=Array.from(r).reduce(function(e,t){return[].concat(d(e),d(t.children))},[]);[].concat(d(t),d(n)).forEach(function(e){return S.observe(e)})})}).call(this,r("../client/node_modules/lodash/fp.js"))},"../client/editor-next/src/components/block-components/ecommerce/utils/generate-preview-sizes.js":function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){c(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(t,"__esModule",{value:!0}),t.generatePreviewSizes=void 0;var i=["original",72,112,144,224,480,700];t.generatePreviewSizes=function(e){return e?i.reduce(function(t,r){return o(o({},t),{},c({},r,"".concat(e,"/").concat(r)))},{}):{}}}}]);